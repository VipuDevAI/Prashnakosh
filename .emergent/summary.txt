<analysis>**original_problem_statement:**
The user initially provided a zip file for an existing education governance application, Prashnakosh. The project's scope then shifted to building a brand-new Super Admin dashboard from scratch to manage schools, users, and settings. Key requirements included a premium UI, a strict database-first policy using PostgreSQL, and the removal of all mock/demo data.

Recently, the user requested a major new feature: an AI-powered question paper parser. This tool should allow the Super Admin to upload PDF or image files of question papers, and use an AI model (OpenAI GPT-4 Vision) to automatically extract, classify, and save the questions into the system's question bank.

**PRODUCT REQUIREMENTS:**
1.  **AI Question Paper Parser (New):**
    *   A UI in the Super Admin dashboard to upload PDF/Image files (typed or scanned).
    *   Dropdowns for classification: School, Class, Subject, Chapter (optional), and Exam Type.
    *   Backend service using a user-provided OpenAI API key to parse the file with GPT-4 Vision.
    *   The AI should extract individual questions, marks, type, options, and difficulty.
    *   The AI should attempt to auto-classify the chapter based on content.
    *   Provide a review screen for the Super Admin to edit and approve the extracted questions before saving them to the database.
2.  **Super Admin Dashboard:**
    *   Full CRUD for schools, users (Principals, HODs, Teachers, Students), and settings (Wings, Exams).
3.  **Data & Storage Policy (Non-Negotiable):**
    *   PostgreSQL is the single source of truth.  must be completely removed.
    *   All dashboards must be driven by real data from the database.
4.  **Exam Authority:**
    *   Exams created by the Super Admin are the single source of truth, consumed by HODs for blueprints and Students for mock tests.
5.  **Principal Analytics Dashboard:**
    *   A PowerBI-style interactive dashboard with real data insights.

**User's preferred language**: English

**what currently exists?**
The application now has a fully functional Super Admin dashboard with a premium, dark/light mode UI. Critically, the entire backend has been refactored to be **PostgreSQL-only**, and all  and mock data dependencies have been removed, fulfilling a key user requirement. The Principal's dashboard now displays real-time analytics from the database. The exam configuration flow is unified, with Super Admin-created exams serving as the single source of truth for all other roles.

Most recently, an **AI Question Paper Parser** feature was implemented. This includes a new UI in the Super Admin panel and a dedicated Python/FastAPI microservice that uses OpenAI GPT-4 Vision to extract questions from uploaded PDF/image files. The feature is built but awaits user testing.

**Last working item**:
- **Last item agent was working:** Finalizing the implementation of the new **AI Question Paper Parser** feature. This involved creating the frontend UI for file upload and classification, building a Python/FastAPI backend microservice to handle the AI parsing with OpenAI, and integrating it into the main application.
- **Status:** USER VERIFICATION PENDING
- **Agent Testing Done:** N (Agent is blocked on receiving the user's OpenAI API key and a sample question paper to test the end-to-end flow).
- **Which testing method agent to use?** Manual testing. The agent needs to receive the file and API key from the user, add the key via the UI, upload the file through the parser page, and verify that the questions are extracted and displayed correctly for review.
- **User Testing Done:** N

**All Pending/In progress Issue list**:
There are no major pending bugs or issues. The primary pending item is the user-driven verification of the newly-built AI Paper Parser.

**In progress Task List**:
- **Task 1: Test and Verify the AI Question Paper Parser (P0)**
    - **Where to resume:** The feature is functionally complete. The agent is waiting for the user to provide a sample 12th-grade computer science question paper and their OpenAI API key to conduct the first end-to-end test.
    - **What will be achieved with this?** This will validate the new AI parsing feature, which is intended to significantly speed up the process of populating the question bank.
    - **Status:** USER VERIFICATION PENDING
    - **Should Test frontend/backend/both after fix?** Both.
    - **Blocked on something:** User needs to provide a sample file (PDF/Image) and their OpenAI API key.

**Upcoming and Future Tasks**
*   **Upcoming Tasks (Post-Verification):**
    *   **P0: Build PowerBI-level Principal Analytics:** After the user completes their Principal demo, the next step is to enhance the Principal Analytics dashboard with more interactive charts, trends, and deep-dive metrics.
    *   **P1: Integrate AWS S3 (Phase C):** Connect the application to a real AWS S3 bucket for persistent file storage. This will enable uploads for the Reference Materials library and question paper attachments.
*   **Future Tasks:**
    *   Clean up and remove the obsolete legacy admin pages under .
    *   Address the pre-existing TypeScript errors from the original codebase.
    *   Formalize a database seed script for initial setup.

**Completed work in this session**
- **AI Question Paper Parser (New Feature):**
  - Implemented a new Super Admin page for uploading and classifying question papers ().
  - Created a Python/FastAPI microservice () to handle parsing with OpenAI GPT-4 Vision.
  - Added a new supervisor process to manage the parser service.
- **MemStorage Completely Removed:**
  - Refactored the entire backend to be **PostgreSQL-only**, removing the  class and all fallback logic. The application now connects directly to a PostgreSQL database, resolving a critical data integrity risk.
- **Exam Authority Flow Unified & Verified:**
  - Modified the HOD blueprint and Student mock test flows to consume exams directly from the  table, which is managed by the Super Admin.
  - Verified the entire flow end-to-end with test users and confirmed that legacy exam definitions are no longer used.
- **Principal Dashboard Demo Data FIXED:**
  - Rewired the Principal Analytics dashboard to fetch all data from real API endpoints connected to the PostgreSQL database, eliminating all hardcoded mock data.
- **Verification & Cleanup:**
  - Performed a full, user-approved verification of the exam authority flows. All test data (users, schools, exams) created during verification was subsequently deleted, leaving the system in a clean state.

**Earlier issues found/mentioned but not fixed**
- **Issue 1: Pre-existing TypeScript Errors**
    - **Debug checklist:** Run client/src/pages/admin/blueprint-policies.tsx(113,9): error TS2322: Type '{ title: string; subtitle: string; actions: Element; }' is not assignable to type 'IntrinsicAttributes & PageHeaderProps'.
  Property 'title' does not exist on type 'IntrinsicAttributes & PageHeaderProps'.
client/src/pages/admin/reference-library.tsx(182,9): error TS2322: Type '{ title: string; subtitle: string; actions: Element; }' is not assignable to type 'IntrinsicAttributes & PageHeaderProps'.
  Property 'title' does not exist on type 'IntrinsicAttributes & PageHeaderProps'.
client/src/pages/admin/user-bulk-upload.tsx(113,9): error TS2322: Type '{ title: string; subtitle: string; actions: Element; }' is not assignable to type 'IntrinsicAttributes & PageHeaderProps'.
  Property 'title' does not exist on type 'IntrinsicAttributes & PageHeaderProps'.
client/src/pages/chapters.tsx(50,24): error TS2802: Type 'Set<string>' can only be iterated through when using the '--downlevelIteration' flag or with a '--target' of 'es2015' or higher.
client/src/pages/practice.tsx(46,24): error TS2802: Type 'Set<string>' can only be iterated through when using the '--downlevelIteration' flag or with a '--target' of 'es2015' or higher.
client/src/pages/practice.tsx(48,11): error TS2802: Type 'Set<string>' can only be iterated through when using the '--downlevelIteration' flag or with a '--target' of 'es2015' or higher.
server/pg-storage.ts(166,43): error TS2769: No overload matches this call.
  Overload 1 of 2, '(value: { name: string | SQL<unknown> | Placeholder<string, any>; email: string | SQL<unknown> | Placeholder<string, any>; password: string | SQL<unknown> | Placeholder<...>; ... 16 more ...; deletedBy?: string | ... 3 more ... | undefined; }): PgInsertBase<...>', gave the following error.
    Argument of type '{ active: boolean; name: string; email: string; password: string; role: "super_admin" | "admin" | "hod" | "principal" | "exam_committee" | "teacher" | "student" | "parent"; tenantId?: string | null | undefined; ... 12 more ...; deletedBy?: string | ... 1 more ... | undefined; }' is not assignable to parameter of type '{ name: string | SQL<unknown> | Placeholder<string, any>; email: string | SQL<unknown> | Placeholder<string, any>; password: string | SQL<unknown> | Placeholder<string, any>; ... 16 more ...; deletedBy?: string | ... 3 more ... | undefined; }'.
      Types of property 'subjects' are incompatible.
        Type '{ [x: number]: string; length: number; toString: () => string; toLocaleString: { (): string; (locales: string | string[], options?: (NumberFormatOptions & DateTimeFormatOptions) | undefined): string; }; ... 37 more ...; readonly [Symbol.unscopables]: { ...; }; } | null | undefined' is not assignable to type 'string[] | SQL<unknown> | Placeholder<string, any> | null | undefined'.
          Type '{ [x: number]: string; length: number; toString: () => string; toLocaleString: { (): string; (locales: string | string[], options?: (NumberFormatOptions & DateTimeFormatOptions) | undefined): string; }; ... 37 more ...; readonly [Symbol.unscopables]: { ...; }; }' is not assignable to type 'string[] | SQL<unknown> | Placeholder<string, any> | null | undefined'.
            Type '{ [x: number]: string; length: number; toString: () => string; toLocaleString: { (): string; (locales: string | string[], options?: (NumberFormatOptions & DateTimeFormatOptions) | undefined): string; }; ... 37 more ...; readonly [Symbol.unscopables]: { ...; }; }' is not assignable to type 'string[]'.
              The types returned by 'pop()' are incompatible between these types.
                Type 'unknown' is not assignable to type 'string | undefined'.
  Overload 2 of 2, '(values: { name: string | SQL<unknown> | Placeholder<string, any>; email: string | SQL<unknown> | Placeholder<string, any>; password: string | SQL<unknown> | Placeholder<...>; ... 16 more ...; deletedBy?: string | ... 3 more ... | undefined; }[]): PgInsertBase<...>', gave the following error.
    Object literal may only specify known properties, and 'active' does not exist in type '{ name: string | SQL<unknown> | Placeholder<string, any>; email: string | SQL<unknown> | Placeholder<string, any>; password: string | SQL<unknown> | Placeholder<string, any>; ... 16 more ...; deletedBy?: string | ... 3 more ... | undefined; }[]'.
server/pg-storage.ts(270,47): error TS2769: No overload matches this call.
  Overload 1 of 3, '(left: PgColumn<{ name: "type"; tableName: "questions"; dataType: "string"; columnType: "PgText"; data: "mcq" | "true_false" | "fill_blank" | "matching" | "numerical" | "short_answer" | "long_answer"; ... 9 more ...; generated: undefined; }, {}, { ...; }>, right: SQLWrapper | ... 6 more ... | "long_answer"): SQL<...>', gave the following error.
    Argument of type 'string' is not assignable to parameter of type 'SQLWrapper | "mcq" | "true_false" | "fill_blank" | "matching" | "numerical" | "short_answer" | "long_answer"'.
  Overload 2 of 3, '(left: Aliased<string>, right: string | SQLWrapper): SQL<unknown>', gave the following error.
    Argument of type 'PgColumn<{ name: "type"; tableName: "questions"; dataType: "string"; columnType: "PgText"; data: "mcq" | "true_false" | "fill_blank" | "matching" | "numerical" | "short_answer" | "long_answer"; ... 9 more ...; generated: undefined; }, {}, { ...; }>' is not assignable to parameter of type 'Aliased<string>'.
      Type 'PgColumn<{ name: "type"; tableName: "questions"; dataType: "string"; columnType: "PgText"; data: "mcq" | "true_false" | "fill_blank" | "matching" | "numerical" | "short_answer" | "long_answer"; ... 9 more ...; generated: undefined; }, {}, { ...; }>' is missing the following properties from type 'Aliased<string>': sql, fieldAlias
  Overload 3 of 3, '(left: never, right: unknown): SQL<unknown>', gave the following error.
    Argument of type 'PgColumn<{ name: "type"; tableName: "questions"; dataType: "string"; columnType: "PgText"; data: "mcq" | "true_false" | "fill_blank" | "matching" | "numerical" | "short_answer" | "long_answer"; ... 9 more ...; generated: undefined; }, {}, { ...; }>' is not assignable to parameter of type 'never'.
server/pg-storage.ts(304,49): error TS2802: Type 'Map<string, { id: string; options: string[] | null; type: "mcq" | "true_false" | "fill_blank" | "matching" | "numerical" | "short_answer" | "long_answer"; status: string | null; tenantId: string; ... 25 more ...; rejectionReason: string | null; }[]>' can only be iterated through when using the '--downlevelIteration' flag or with a '--target' of 'es2015' or higher.
server/pg-storage.ts(833,60): error TS2769: No overload matches this call.
  Overload 1 of 2, '(value: { name: string | SQL<unknown> | Placeholder<string, any>; tenantId: string | SQL<unknown> | Placeholder<string, any>; grade: string | SQL<unknown> | Placeholder<...>; ... 16 more ...; isApproved?: boolean | ... 3 more ... | undefined; }): PgInsertBase<...>', gave the following error.
    Argument of type '{ name: string; tenantId: string; grade: string; subject: string; totalMarks: number; isLocked?: boolean | null | undefined; lockedAt?: Date | null | undefined; lockedBy?: string | null | undefined; ... 10 more ...; isApproved?: boolean | ... 1 more ... | undefined; }' is not assignable to parameter of type '{ name: string | SQL<unknown> | Placeholder<string, any>; tenantId: string | SQL<unknown> | Placeholder<string, any>; grade: string | SQL<unknown> | Placeholder<string, any>; ... 16 more ...; isApproved?: boolean | ... 3 more ... | undefined; }'.
      Types of property 'sections' are incompatible.
        Type '{ [x: number]: { name: string; marks: number; questionCount: number; questionType: string; difficulty?: unknown; chapters?: unknown; instructions?: unknown; }; length: number; toString: () => string; toLocaleString: { (): string; (locales: string | string[], options?: (NumberFormatOptions & DateTimeFormatOptions) | ...' is not assignable to type 'SQL<unknown> | BlueprintSection[] | Placeholder<string, any> | null | undefined'.
          Type '{ [x: number]: { name: string; marks: number; questionCount: number; questionType: string; difficulty?: unknown; chapters?: unknown; instructions?: unknown; }; length: number; toString: () => string; toLocaleString: { (): string; (locales: string | string[], options?: (NumberFormatOptions & DateTimeFormatOptions) | ...' is not assignable to type 'SQL<unknown> | BlueprintSection[] | Placeholder<string, any> | null | undefined'.
            Type '{ [x: number]: { name: string; marks: number; questionCount: number; questionType: string; difficulty?: unknown; chapters?: unknown; instructions?: unknown; }; length: number; toString: () => string; toLocaleString: { (): string; (locales: string | string[], options?: (NumberFormatOptions & DateTimeFormatOptions) | ...' is not assignable to type 'BlueprintSection[]'.
              The types returned by 'pop()' are incompatible between these types.
                Type 'unknown' is not assignable to type 'BlueprintSection | undefined'.
  Overload 2 of 2, '(values: { name: string | SQL<unknown> | Placeholder<string, any>; tenantId: string | SQL<unknown> | Placeholder<string, any>; grade: string | SQL<unknown> | Placeholder<...>; ... 16 more ...; isApproved?: boolean | ... 3 more ... | undefined; }[]): PgInsertBase<...>', gave the following error.
    Argument of type '{ name: string; tenantId: string; grade: string; subject: string; totalMarks: number; isLocked?: boolean | null | undefined; lockedAt?: Date | null | undefined; lockedBy?: string | null | undefined; ... 10 more ...; isApproved?: boolean | ... 1 more ... | undefined; }' is not assignable to parameter of type '{ name: string | SQL<unknown> | Placeholder<string, any>; tenantId: string | SQL<unknown> | Placeholder<string, any>; grade: string | SQL<unknown> | Placeholder<string, any>; ... 16 more ...; isApproved?: boolean | ... 3 more ... | undefined; }[]'.
      Type '{ name: string; tenantId: string; grade: string; subject: string; totalMarks: number; isLocked?: boolean | null | undefined; lockedAt?: Date | null | undefined; lockedBy?: string | null | undefined; ... 10 more ...; isApproved?: boolean | ... 1 more ... | undefined; }' is missing the following properties from type '{ name: string | SQL<unknown> | Placeholder<string, any>; tenantId: string | SQL<unknown> | Placeholder<string, any>; grade: string | SQL<unknown> | Placeholder<string, any>; ... 16 more ...; isApproved?: boolean | ... 3 more ... | undefined; }[]': length, pop, push, concat, and 35 more.
server/pg-storage.ts(859,63): error TS2769: No overload matches this call.
  Overload 1 of 2, '(value: { questionId: string | SQL<unknown> | Placeholder<string, any>; reviewerId: string | SQL<unknown> | Placeholder<string, any>; id?: string | SQL<unknown> | Placeholder<...> | undefined; status?: SQL<...> | ... 5 more ... | undefined; reviewedAt?: SQL<...> | ... 3 more ... | undefined; comments?: string | ... 3 more ... | undefined; }): PgInsertBase<...>', gave the following error.
    Type 'string' is not assignable to type 'SQL<unknown> | "pending" | "approved" | "rejected" | Placeholder<string, any> | null | undefined'.
  Overload 2 of 2, '(values: { questionId: string | SQL<unknown> | Placeholder<string, any>; reviewerId: string | SQL<unknown> | Placeholder<string, any>; id?: string | SQL<unknown> | Placeholder<...> | undefined; status?: SQL<...> | ... 5 more ... | undefined; reviewedAt?: SQL<...> | ... 3 more ... | undefined; comments?: string | ... 3 more ... | undefined; }[]): PgInsertBase<...>', gave the following error.
    Object literal may only specify known properties, and 'questionId' does not exist in type '{ questionId: string | SQL<unknown> | Placeholder<string, any>; reviewerId: string | SQL<unknown> | Placeholder<string, any>; id?: string | SQL<unknown> | Placeholder<...> | undefined; status?: SQL<...> | ... 5 more ... | undefined; reviewedAt?: SQL<...> | ... 3 more ... | undefined; comments?: string | ... 3 more ....'.
server/pg-storage.ts(1048,62): error TS2769: No overload matches this call.
  Overload 1 of 2, '(value: { tenantId: string | SQL<unknown> | Placeholder<string, any>; examId: string | SQL<unknown> | Placeholder<string, any>; toState: SQL<unknown> | "active" | ... 11 more ... | Placeholder<...>; ... 5 more ...; timestamp?: SQL<...> | ... 2 more ... | undefined; }): PgInsertBase<...>', gave the following error.
    Argument of type '{ tenantId: string; examId: string; toState: string; actorId: string; actorRole: string; comments?: string | null | undefined; fromState?: any; timestamp?: Date | undefined; }' is not assignable to parameter of type '{ tenantId: string | SQL<unknown> | Placeholder<string, any>; examId: string | SQL<unknown> | Placeholder<string, any>; toState: SQL<unknown> | "active" | ... 11 more ... | Placeholder<...>; ... 5 more ...; timestamp?: SQL<...> | ... 2 more ... | undefined; }'.
      Types of property 'toState' are incompatible.
        Type 'string' is not assignable to type 'SQL<unknown> | "active" | "draft" | "locked" | "submitted" | "pending_hod" | "hod_approved" | "hod_rejected" | "pending_principal" | "principal_approved" | "principal_rejected" | "sent_to_committee" | "archived" | Placeholder<...>'.
  Overload 2 of 2, '(values: { tenantId: string | SQL<unknown> | Placeholder<string, any>; examId: string | SQL<unknown> | Placeholder<string, any>; toState: SQL<unknown> | "active" | ... 11 more ... | Placeholder<...>; ... 5 more ...; timestamp?: SQL<...> | ... 2 more ... | undefined; }[]): PgInsertBase<...>', gave the following error.
    Argument of type '{ tenantId: string; examId: string; toState: string; actorId: string; actorRole: string; comments?: string | null | undefined; fromState?: any; timestamp?: Date | undefined; }' is not assignable to parameter of type '{ tenantId: string | SQL<unknown> | Placeholder<string, any>; examId: string | SQL<unknown> | Placeholder<string, any>; toState: SQL<unknown> | "active" | ... 11 more ... | Placeholder<...>; ... 5 more ...; timestamp?: SQL<...> | ... 2 more ... | undefined; }[]'.
      Type '{ tenantId: string; examId: string; toState: string; actorId: string; actorRole: string; comments?: string | null | undefined; fromState?: any; timestamp?: Date | undefined; }' is missing the following properties from type '{ tenantId: string | SQL<unknown> | Placeholder<string, any>; examId: string | SQL<unknown> | Placeholder<string, any>; toState: SQL<unknown> | "active" | ... 11 more ... | Placeholder<...>; ... 5 more ...; timestamp?: SQL<...> | ... 2 more ... | undefined; }[]': length, pop, push, concat, and 35 more.
server/pg-storage.ts(1144,76): error TS2769: No overload matches this call.
  Overload 1 of 2, '(value: { message: string | SQL<unknown> | Placeholder<string, any>; type: SQL<unknown> | "test_unlocked" | "exam_submitted" | "result_published" | Placeholder<string, any>; ... 7 more ...; isRead?: boolean | ... 3 more ... | undefined; }): PgInsertBase<...>', gave the following error.
    Argument of type '{ message: string; type: string; tenantId: string; title: string; studentId: string; createdAt?: Date | null | undefined; testId?: string | null | undefined; attemptId?: string | null | undefined; isRead?: boolean | ... 1 more ... | undefined; }' is not assignable to parameter of type '{ message: string | SQL<unknown> | Placeholder<string, any>; type: SQL<unknown> | "test_unlocked" | "exam_submitted" | "result_published" | Placeholder<string, any>; ... 7 more ...; isRead?: boolean | ... 3 more ... | undefined; }'.
      Types of property 'type' are incompatible.
        Type 'string' is not assignable to type 'SQL<unknown> | "test_unlocked" | "exam_submitted" | "result_published" | Placeholder<string, any>'.
  Overload 2 of 2, '(values: { message: string | SQL<unknown> | Placeholder<string, any>; type: SQL<unknown> | "test_unlocked" | "exam_submitted" | "result_published" | Placeholder<string, any>; ... 7 more ...; isRead?: boolean | ... 3 more ... | undefined; }[]): PgInsertBase<...>', gave the following error.
    Argument of type '{ message: string; type: string; tenantId: string; title: string; studentId: string; createdAt?: Date | null | undefined; testId?: string | null | undefined; attemptId?: string | null | undefined; isRead?: boolean | ... 1 more ... | undefined; }' is not assignable to parameter of type '{ message: string | SQL<unknown> | Placeholder<string, any>; type: SQL<unknown> | "test_unlocked" | "exam_submitted" | "result_published" | Placeholder<string, any>; ... 7 more ...; isRead?: boolean | ... 3 more ... | undefined; }[]'.
      Type '{ message: string; type: string; tenantId: string; title: string; studentId: string; createdAt?: Date | null | undefined; testId?: string | null | undefined; attemptId?: string | null | undefined; isRead?: boolean | ... 1 more ... | undefined; }' is missing the following properties from type '{ message: string | SQL<unknown> | Placeholder<string, any>; type: SQL<unknown> | "test_unlocked" | "exam_submitted" | "result_published" | Placeholder<string, any>; ... 7 more ...; isRead?: boolean | ... 3 more ... | undefined; }[]': length, pop, push, concat, and 35 more.
server/pg-storage.ts(1473,60): error TS2769: No overload matches this call.
  Overload 1 of 2, '(value: { tenantId: string | SQL<unknown> | Placeholder<string, any>; academicYearId: string | SQL<unknown> | Placeholder<string, any>; grade: string | SQL<...> | Placeholder<...>; ... 4 more ...; displayName?: string | ... 3 more ... | undefined; }): PgInsertBase<...>', gave the following error.
    Argument of type '{ tenantId: string; academicYearId: string; grade: string; isActive?: boolean | null | undefined; createdAt?: Date | null | undefined; gradeGroup?: string | null | undefined; displayName?: string | ... 1 more ... | undefined; }' is not assignable to parameter of type '{ tenantId: string | SQL<unknown> | Placeholder<string, any>; academicYearId: string | SQL<unknown> | Placeholder<string, any>; grade: string | SQL<unknown> | Placeholder<...>; ... 4 more ...; displayName?: string | ... 3 more ... | undefined; }'.
      Types of property 'gradeGroup' are incompatible.
        Type 'string | null | undefined' is not assignable to type 'SQL<unknown> | "primary" | "middle" | "senior" | Placeholder<string, any> | null | undefined'.
          Type 'string' is not assignable to type 'SQL<unknown> | "primary" | "middle" | "senior" | Placeholder<string, any> | null | undefined'.
  Overload 2 of 2, '(values: { tenantId: string | SQL<unknown> | Placeholder<string, any>; academicYearId: string | SQL<unknown> | Placeholder<string, any>; grade: string | SQL<...> | Placeholder<...>; ... 4 more ...; displayName?: string | ... 3 more ... | undefined; }[]): PgInsertBase<...>', gave the following error.
    Argument of type '{ tenantId: string; academicYearId: string; grade: string; isActive?: boolean | null | undefined; createdAt?: Date | null | undefined; gradeGroup?: string | null | undefined; displayName?: string | ... 1 more ... | undefined; }' is not assignable to parameter of type '{ tenantId: string | SQL<unknown> | Placeholder<string, any>; academicYearId: string | SQL<unknown> | Placeholder<string, any>; grade: string | SQL<unknown> | Placeholder<...>; ... 4 more ...; displayName?: string | ... 3 more ... | undefined; }[]'.
      Type '{ tenantId: string; academicYearId: string; grade: string; isActive?: boolean | null | undefined; createdAt?: Date | null | undefined; gradeGroup?: string | null | undefined; displayName?: string | ... 1 more ... | undefined; }' is missing the following properties from type '{ tenantId: string | SQL<unknown> | Placeholder<string, any>; academicYearId: string | SQL<unknown> | Placeholder<string, any>; grade: string | SQL<unknown> | Placeholder<...>; ... 4 more ...; displayName?: string | ... 3 more ... | undefined; }[]': length, pop, push, concat, and 35 more.
server/pg-storage.ts(1479,49): error TS2769: No overload matches this call.
  Overload 1 of 2, '(value: { tenantId: string | SQL<unknown> | Placeholder<string, any>; academicYearId: string | SQL<unknown> | Placeholder<string, any>; grade: string | SQL<...> | Placeholder<...>; ... 4 more ...; displayName?: string | ... 3 more ... | undefined; }): PgInsertBase<...>', gave the following error.
    Argument of type '{ tenantId: string; academicYearId: string; grade: string; isActive?: boolean | null | undefined; createdAt?: Date | null | undefined; gradeGroup?: string | null | undefined; displayName?: string | ... 1 more ... | undefined; }[]' is not assignable to parameter of type '{ tenantId: string | SQL<unknown> | Placeholder<string, any>; academicYearId: string | SQL<unknown> | Placeholder<string, any>; grade: string | SQL<unknown> | Placeholder<...>; ... 4 more ...; displayName?: string | ... 3 more ... | undefined; }'.
      Type '{ tenantId: string; academicYearId: string; grade: string; isActive?: boolean | null | undefined; createdAt?: Date | null | undefined; gradeGroup?: string | null | undefined; displayName?: string | ... 1 more ... | undefined; }[]' is missing the following properties from type '{ tenantId: string | SQL<unknown> | Placeholder<string, any>; academicYearId: string | SQL<unknown> | Placeholder<string, any>; grade: string | SQL<unknown> | Placeholder<...>; ... 4 more ...; displayName?: string | ... 3 more ... | undefined; }': tenantId, academicYearId, grade
  Overload 2 of 2, '(values: { tenantId: string | SQL<unknown> | Placeholder<string, any>; academicYearId: string | SQL<unknown> | Placeholder<string, any>; grade: string | SQL<...> | Placeholder<...>; ... 4 more ...; displayName?: string | ... 3 more ... | undefined; }[]): PgInsertBase<...>', gave the following error.
    Argument of type '{ tenantId: string; academicYearId: string; grade: string; isActive?: boolean | null | undefined; createdAt?: Date | null | undefined; gradeGroup?: string | null | undefined; displayName?: string | ... 1 more ... | undefined; }[]' is not assignable to parameter of type '{ tenantId: string | SQL<unknown> | Placeholder<string, any>; academicYearId: string | SQL<unknown> | Placeholder<string, any>; grade: string | SQL<unknown> | Placeholder<...>; ... 4 more ...; displayName?: string | ... 3 more ... | undefined; }[]'.
      Type '{ tenantId: string; academicYearId: string; grade: string; isActive?: boolean | null | undefined; createdAt?: Date | null | undefined; gradeGroup?: string | null | undefined; displayName?: string | ... 1 more ... | undefined; }' is not assignable to type '{ tenantId: string | SQL<unknown> | Placeholder<string, any>; academicYearId: string | SQL<unknown> | Placeholder<string, any>; grade: string | SQL<unknown> | Placeholder<...>; ... 4 more ...; displayName?: string | ... 3 more ... | undefined; }'.
        Types of property 'gradeGroup' are incompatible.
          Type 'string | null | undefined' is not assignable to type 'SQL<unknown> | "primary" | "middle" | "senior" | Placeholder<string, any> | null | undefined'.
            Type 'string' is not assignable to type 'SQL<unknown> | "primary" | "middle" | "senior" | Placeholder<string, any> | null | undefined'.
server/pg-storage.ts(1613,62): error TS2769: No overload matches this call.
  Overload 1 of 2, '(value: { tenantId: string | SQL<unknown> | Placeholder<string, any>; academicYearId: string | SQL<unknown> | Placeholder<string, any>; gradeGroup: SQL<unknown> | "primary" | "middle" | "senior" | Placeholder<...>; ... 13 more ...; isVisible?: boolean | ... 3 more ... | undefined; }): PgInsertBase<...>', gave the following error.
    Argument of type '{ tenantId: string; academicYearId: string; gradeGroup: string; examName: string; startDate?: Date | null | undefined; endDate?: Date | null | undefined; isActive?: boolean | null | undefined; ... 8 more ...; isVisible?: boolean | ... 1 more ... | undefined; }' is not assignable to parameter of type '{ tenantId: string | SQL<unknown> | Placeholder<string, any>; academicYearId: string | SQL<unknown> | Placeholder<string, any>; gradeGroup: SQL<unknown> | "primary" | "middle" | "senior" | Placeholder<...>; ... 13 more ...; isVisible?: boolean | ... 3 more ... | undefined; }'.
      Types of property 'gradeGroup' are incompatible.
        Type 'string' is not assignable to type 'SQL<unknown> | "primary" | "middle" | "senior" | Placeholder<string, any>'.
  Overload 2 of 2, '(values: { tenantId: string | SQL<unknown> | Placeholder<string, any>; academicYearId: string | SQL<unknown> | Placeholder<string, any>; gradeGroup: SQL<unknown> | "primary" | "middle" | "senior" | Placeholder<...>; ... 13 more ...; isVisible?: boolean | ... 3 more ... | undefined; }[]): PgInsertBase<...>', gave the following error.
    Argument of type '{ tenantId: string; academicYearId: string; gradeGroup: string; examName: string; startDate?: Date | null | undefined; endDate?: Date | null | undefined; isActive?: boolean | null | undefined; ... 8 more ...; isVisible?: boolean | ... 1 more ... | undefined; }' is not assignable to parameter of type '{ tenantId: string | SQL<unknown> | Placeholder<string, any>; academicYearId: string | SQL<unknown> | Placeholder<string, any>; gradeGroup: SQL<unknown> | "primary" | "middle" | "senior" | Placeholder<...>; ... 13 more ...; isVisible?: boolean | ... 3 more ... | undefined; }[]'.
      Type '{ tenantId: string; academicYearId: string; gradeGroup: string; examName: string; startDate?: Date | null | undefined; endDate?: Date | null | undefined; isActive?: boolean | null | undefined; ... 8 more ...; isVisible?: boolean | ... 1 more ... | undefined; }' is missing the following properties from type '{ tenantId: string | SQL<unknown> | Placeholder<string, any>; academicYearId: string | SQL<unknown> | Placeholder<string, any>; gradeGroup: SQL<unknown> | "primary" | "middle" | "senior" | Placeholder<...>; ... 13 more ...; isVisible?: boolean | ... 3 more ... | undefined; }[]': length, pop, push, concat, and 35 more.
server/pg-storage.ts(1641,65): error TS2769: No overload matches this call.
  Overload 1 of 2, '(value: { tenantId: string | SQL<unknown> | Placeholder<string, any>; academicYearId: string | SQL<unknown> | Placeholder<string, any>; id?: string | SQL<unknown> | Placeholder<...> | undefined; ... 5 more ...; updatedBy?: string | ... 3 more ... | undefined; }): PgInsertBase<...>', gave the following error.
    Argument of type '{ tenantId: string; academicYearId: string; createdAt?: Date | null | undefined; isBlueprintMandatory?: boolean | null | undefined; blueprintMode?: string | null | undefined; allowEditAfterLock?: boolean | ... 1 more ... | undefined; updatedAt?: Date | ... 1 more ... | undefined; updatedBy?: string | ... 1 more ... ...' is not assignable to parameter of type '{ tenantId: string | SQL<unknown> | Placeholder<string, any>; academicYearId: string | SQL<unknown> | Placeholder<string, any>; id?: string | SQL<unknown> | Placeholder<...> | undefined; ... 5 more ...; updatedBy?: string | ... 3 more ... | undefined; }'.
      Types of property 'blueprintMode' are incompatible.
        Type 'string | null | undefined' is not assignable to type 'SQL<unknown> | "academic_year" | "exam_specific" | Placeholder<string, any> | null | undefined'.
          Type 'string' is not assignable to type 'SQL<unknown> | "academic_year" | "exam_specific" | Placeholder<string, any> | null | undefined'.
  Overload 2 of 2, '(values: { tenantId: string | SQL<unknown> | Placeholder<string, any>; academicYearId: string | SQL<unknown> | Placeholder<string, any>; id?: string | SQL<unknown> | Placeholder<...> | undefined; ... 5 more ...; updatedBy?: string | ... 3 more ... | undefined; }[]): PgInsertBase<...>', gave the following error.
    Argument of type '{ tenantId: string; academicYearId: string; createdAt?: Date | null | undefined; isBlueprintMandatory?: boolean | null | undefined; blueprintMode?: string | null | undefined; allowEditAfterLock?: boolean | ... 1 more ... | undefined; updatedAt?: Date | ... 1 more ... | undefined; updatedBy?: string | ... 1 more ... ...' is not assignable to parameter of type '{ tenantId: string | SQL<unknown> | Placeholder<string, any>; academicYearId: string | SQL<unknown> | Placeholder<string, any>; id?: string | SQL<unknown> | Placeholder<...> | undefined; ... 5 more ...; updatedBy?: string | ... 3 more ... | undefined; }[]'.
      Type '{ tenantId: string; academicYearId: string; createdAt?: Date | null | undefined; isBlueprintMandatory?: boolean | null | undefined; blueprintMode?: string | null | undefined; allowEditAfterLock?: boolean | ... 1 more ... | undefined; updatedAt?: Date | ... 1 more ... | undefined; updatedBy?: string | ... 1 more ... ...' is missing the following properties from type '{ tenantId: string | SQL<unknown> | Placeholder<string, any>; academicYearId: string | SQL<unknown> | Placeholder<string, any>; id?: string | SQL<unknown> | Placeholder<...> | undefined; ... 5 more ...; updatedBy?: string | ... 3 more ... | undefined; }[]': length, pop, push, concat, and 35 more.
server/pg-storage.ts(1676,64): error TS2769: No overload matches this call.
  Overload 1 of 2, '(value: { tenantId: string | SQL<unknown> | Placeholder<string, any>; grade: string | SQL<unknown> | Placeholder<string, any>; title: string | SQL<unknown> | Placeholder<...>; ... 14 more ...; year?: string | ... 3 more ... | undefined; }): PgInsertBase<...>', gave the following error.
    Argument of type '{ tenantId: string; grade: string; title: string; subject: string; referenceType: string; fileUrl: string; isActive?: boolean | null | undefined; createdAt?: Date | null | undefined; ... 8 more ...; year?: string | ... 1 more ... | undefined; }' is not assignable to parameter of type '{ tenantId: string | SQL<unknown> | Placeholder<string, any>; grade: string | SQL<unknown> | Placeholder<string, any>; title: string | SQL<unknown> | Placeholder<...>; ... 14 more ...; year?: string | ... 3 more ... | undefined; }'.
      Types of property 'referenceType' are incompatible.
        Type 'string' is not assignable to type 'SQL<unknown> | "question_paper" | "notes" | "model_answer" | "study_material" | Placeholder<string, any>'.
  Overload 2 of 2, '(values: { tenantId: string | SQL<unknown> | Placeholder<string, any>; grade: string | SQL<unknown> | Placeholder<string, any>; title: string | SQL<unknown> | Placeholder<...>; ... 14 more ...; year?: string | ... 3 more ... | undefined; }[]): PgInsertBase<...>', gave the following error.
    Argument of type '{ tenantId: string; grade: string; title: string; subject: string; referenceType: string; fileUrl: string; isActive?: boolean | null | undefined; createdAt?: Date | null | undefined; ... 8 more ...; year?: string | ... 1 more ... | undefined; }' is not assignable to parameter of type '{ tenantId: string | SQL<unknown> | Placeholder<string, any>; grade: string | SQL<unknown> | Placeholder<string, any>; title: string | SQL<unknown> | Placeholder<...>; ... 14 more ...; year?: string | ... 3 more ... | undefined; }[]'.
      Type '{ tenantId: string; grade: string; title: string; subject: string; referenceType: string; fileUrl: string; isActive?: boolean | null | undefined; createdAt?: Date | null | undefined; ... 8 more ...; year?: string | ... 1 more ... | undefined; }' is missing the following properties from type '{ tenantId: string | SQL<unknown> | Placeholder<string, any>; grade: string | SQL<unknown> | Placeholder<string, any>; title: string | SQL<unknown> | Placeholder<...>; ... 14 more ...; year?: string | ... 3 more ... | undefined; }[]': length, pop, push, concat, and 35 more.
server/pg-storage.ts(1703,68): error TS2769: No overload matches this call.
  Overload 1 of 2, '(value: { tenantId: string | SQL<unknown> | Placeholder<string, any>; testId: string | SQL<unknown> | Placeholder<string, any>; userRole: SQL<unknown> | "super_admin" | ... 7 more ... | Placeholder<...>; ... 5 more ...; metadata?: SQL<...> | ... 3 more ... | undefined; }): PgInsertBase<...>', gave the following error.
    Argument of type '{ tenantId: string; testId: string; userRole: string; action: string; setNumber: number; generatedBy: string; generatedAt?: Date | undefined; metadata?: { [x: string]: [any, ...any[]]; } | null | undefined; }' is not assignable to parameter of type '{ tenantId: string | SQL<unknown> | Placeholder<string, any>; testId: string | SQL<unknown> | Placeholder<string, any>; userRole: SQL<unknown> | "super_admin" | ... 7 more ... | Placeholder<...>; ... 5 more ...; metadata?: SQL<...> | ... 3 more ... | undefined; }'.
      Types of property 'userRole' are incompatible.
        Type 'string' is not assignable to type 'SQL<unknown> | "super_admin" | "admin" | "hod" | "principal" | "exam_committee" | "teacher" | "student" | "parent" | Placeholder<string, any>'.
  Overload 2 of 2, '(values: { tenantId: string | SQL<unknown> | Placeholder<string, any>; testId: string | SQL<unknown> | Placeholder<string, any>; userRole: SQL<unknown> | "super_admin" | ... 7 more ... | Placeholder<...>; ... 5 more ...; metadata?: SQL<...> | ... 3 more ... | undefined; }[]): PgInsertBase<...>', gave the following error.
    Argument of type '{ tenantId: string; testId: string; userRole: string; action: string; setNumber: number; generatedBy: string; generatedAt?: Date | undefined; metadata?: { [x: string]: [any, ...any[]]; } | null | undefined; }' is not assignable to parameter of type '{ tenantId: string | SQL<unknown> | Placeholder<string, any>; testId: string | SQL<unknown> | Placeholder<string, any>; userRole: SQL<unknown> | "super_admin" | ... 7 more ... | Placeholder<...>; ... 5 more ...; metadata?: SQL<...> | ... 3 more ... | undefined; }[]'.
      Type '{ tenantId: string; testId: string; userRole: string; action: string; setNumber: number; generatedBy: string; generatedAt?: Date | undefined; metadata?: { [x: string]: [any, ...any[]]; } | null | undefined; }' is missing the following properties from type '{ tenantId: string | SQL<unknown> | Placeholder<string, any>; testId: string | SQL<unknown> | Placeholder<string, any>; userRole: SQL<unknown> | "super_admin" | ... 7 more ... | Placeholder<...>; ... 5 more ...; metadata?: SQL<...> | ... 3 more ... | undefined; }[]': length, pop, push, concat, and 35 more.
server/pg-storage.ts(1785,57): error TS2769: No overload matches this call.
  Overload 1 of 2, '(value: { tenantId: string | SQL<unknown> | Placeholder<string, any>; academicYearId: string | SQL<unknown> | Placeholder<string, any>; examName: string | SQL<...> | Placeholder<...>; ... 15 more ...; allowMockTest?: boolean | ... 3 more ... | undefined; }): PgInsertBase<...>', gave the following error.
    Argument of type '{ isActive: boolean; isDeleted: false; tenantId: string; academicYearId: string; examName: string; wing: string; createdAt?: Date | null | undefined; deletedAt?: Date | null | undefined; ... 9 more ...; allowMockTest?: boolean | ... 1 more ... | undefined; }' is not assignable to parameter of type '{ tenantId: string | SQL<unknown> | Placeholder<string, any>; academicYearId: string | SQL<unknown> | Placeholder<string, any>; examName: string | SQL<...> | Placeholder<...>; ... 15 more ...; allowMockTest?: boolean | ... 3 more ... | undefined; }'.
      Types of property 'wing' are incompatible.
        Type 'string' is not assignable to type 'SQL<unknown> | "primary" | "middle" | "secondary" | "senior_secondary" | Placeholder<string, any>'.
  Overload 2 of 2, '(values: { tenantId: string | SQL<unknown> | Placeholder<string, any>; academicYearId: string | SQL<unknown> | Placeholder<string, any>; examName: string | SQL<...> | Placeholder<...>; ... 15 more ...; allowMockTest?: boolean | ... 3 more ... | undefined; }[]): PgInsertBase<...>', gave the following error.
    Object literal may only specify known properties, and 'isActive' does not exist in type '{ tenantId: string | SQL<unknown> | Placeholder<string, any>; academicYearId: string | SQL<unknown> | Placeholder<string, any>; examName: string | SQL<...> | Placeholder<...>; ... 15 more ...; allowMockTest?: boolean | ... 3 more ... | undefined; }[]'.
server/pg-storage.ts(1882,52): error TS2769: No overload matches this call.
  Overload 1 of 2, '(value: { name: string | SQL<unknown> | Placeholder<string, any>; tenantId: string | SQL<unknown> | Placeholder<string, any>; displayName: string | SQL<unknown> | Placeholder<...>; ... 6 more ...; sortOrder?: number | ... 3 more ... | undefined; }): PgInsertBase<...>', gave the following error.
    Argument of type '{ isActive: boolean; isDeleted: false; name: string; tenantId: string; displayName: string; createdAt?: Date | null | undefined; grades?: { [x: number]: string; length: number; toString: () => string; ... 38 more ...; readonly [Symbol.unscopables]: { ...; }; } | null | undefined; updatedAt?: Date | ... 1 more ... | ...' is not assignable to parameter of type '{ name: string | SQL<unknown> | Placeholder<string, any>; tenantId: string | SQL<unknown> | Placeholder<string, any>; displayName: string | SQL<unknown> | Placeholder<...>; ... 6 more ...; sortOrder?: number | ... 3 more ... | undefined; }'.
      Types of property 'grades' are incompatible.
        Type '{ [x: number]: string; length: number; toString: () => string; toLocaleString: { (): string; (locales: string | string[], options?: (NumberFormatOptions & DateTimeFormatOptions) | undefined): string; }; ... 37 more ...; readonly [Symbol.unscopables]: { ...; }; } | null | undefined' is not assignable to type 'string[] | SQL<unknown> | Placeholder<string, any> | null | undefined'.
          Type '{ [x: number]: string; length: number; toString: () => string; toLocaleString: { (): string; (locales: string | string[], options?: (NumberFormatOptions & DateTimeFormatOptions) | undefined): string; }; ... 37 more ...; readonly [Symbol.unscopables]: { ...; }; }' is not assignable to type 'string[] | SQL<unknown> | Placeholder<string, any> | null | undefined'.
            Type '{ [x: number]: string; length: number; toString: () => string; toLocaleString: { (): string; (locales: string | string[], options?: (NumberFormatOptions & DateTimeFormatOptions) | undefined): string; }; ... 37 more ...; readonly [Symbol.unscopables]: { ...; }; }' is not assignable to type 'string[]'.
              The types returned by 'pop()' are incompatible between these types.
                Type 'unknown' is not assignable to type 'string | undefined'.
  Overload 2 of 2, '(values: { name: string | SQL<unknown> | Placeholder<string, any>; tenantId: string | SQL<unknown> | Placeholder<string, any>; displayName: string | SQL<unknown> | Placeholder<...>; ... 6 more ...; sortOrder?: number | ... 3 more ... | undefined; }[]): PgInsertBase<...>', gave the following error.
    Object literal may only specify known properties, and 'isActive' does not exist in type '{ name: string | SQL<unknown> | Placeholder<string, any>; tenantId: string | SQL<unknown> | Placeholder<string, any>; displayName: string | SQL<unknown> | Placeholder<...>; ... 6 more ...; sortOrder?: number | ... 3 more ... | undefined; }[]'.
server/pg-storage.ts(1941,52): error TS2769: No overload matches this call.
  Overload 1 of 2, '(value: { tenantId: string | SQL<unknown> | Placeholder<string, any>; wingId: string | SQL<unknown> | Placeholder<string, any>; examName: string | SQL<unknown> | Placeholder<...>; ... 15 more ...; allowMockTest?: boolean | ... 3 more ... | undefined; }): PgInsertBase<...>', gave the following error.
    Argument of type '{ isActive: boolean; isDeleted: false; tenantId: string; wingId: string; examName: string; academicYear: string; createdAt?: Date | null | undefined; subjects?: { [x: number]: string; length: number; ... 39 more ...; readonly [Symbol.unscopables]: { ...; }; } | null | undefined; ... 9 more ...; allowMockTest?: boole...' is not assignable to parameter of type '{ tenantId: string | SQL<unknown> | Placeholder<string, any>; wingId: string | SQL<unknown> | Placeholder<string, any>; examName: string | SQL<unknown> | Placeholder<...>; ... 15 more ...; allowMockTest?: boolean | ... 3 more ... | undefined; }'.
      Types of property 'subjects' are incompatible.
        Type '{ [x: number]: string; length: number; toString: () => string; toLocaleString: { (): string; (locales: string | string[], options?: (NumberFormatOptions & DateTimeFormatOptions) | undefined): string; }; ... 37 more ...; readonly [Symbol.unscopables]: { ...; }; } | null | undefined' is not assignable to type 'string[] | SQL<unknown> | Placeholder<string, any> | null | undefined'.
          Type '{ [x: number]: string; length: number; toString: () => string; toLocaleString: { (): string; (locales: string | string[], options?: (NumberFormatOptions & DateTimeFormatOptions) | undefined): string; }; ... 37 more ...; readonly [Symbol.unscopables]: { ...; }; }' is not assignable to type 'string[] | SQL<unknown> | Placeholder<string, any> | null | undefined'.
            Type '{ [x: number]: string; length: number; toString: () => string; toLocaleString: { (): string; (locales: string | string[], options?: (NumberFormatOptions & DateTimeFormatOptions) | undefined): string; }; ... 37 more ...; readonly [Symbol.unscopables]: { ...; }; }' is not assignable to type 'string[]'.
              The types returned by 'pop()' are incompatible between these types.
                Type 'unknown' is not assignable to type 'string | undefined'.
  Overload 2 of 2, '(values: { tenantId: string | SQL<unknown> | Placeholder<string, any>; wingId: string | SQL<unknown> | Placeholder<string, any>; examName: string | SQL<unknown> | Placeholder<...>; ... 15 more ...; allowMockTest?: boolean | ... 3 more ... | undefined; }[]): PgInsertBase<...>', gave the following error.
    Object literal may only specify known properties, and 'isActive' does not exist in type '{ tenantId: string | SQL<unknown> | Placeholder<string, any>; wingId: string | SQL<unknown> | Placeholder<string, any>; examName: string | SQL<unknown> | Placeholder<...>; ... 15 more ...; allowMockTest?: boolean | ... 3 more ... | undefined; }[]'.
server/routes.ts(1089,36): error TS2339: Property 'getUpload' does not exist on type 'IStorage'.
server/routes.ts(2693,40): error TS2802: Type 'Map<string, { passage: any; questions: { id: string; options: string[] | null; type: "mcq" | "true_false" | "fill_blank" | "matching" | "numerical" | "short_answer" | "long_answer"; status: string | null; ... 26 more ...; rejectionReason: string | null; }[]; }>' can only be iterated through when using the '--downlevelIteration' flag or with a '--target' of 'es2015' or higher.
server/routes.ts(2874,40): error TS2802: Type 'Map<string, { passage: any; questions: { id: string; options: string[] | null; type: "mcq" | "true_false" | "fill_blank" | "matching" | "numerical" | "short_answer" | "long_answer"; status: string | null; ... 26 more ...; rejectionReason: string | null; }[]; }>' can only be iterated through when using the '--downlevelIteration' flag or with a '--target' of 'es2015' or higher.
server/routes.ts(3292,20): error TS2322: Type 'string' is not assignable to type '[any, ...any[]]'.
server/routes.ts(3323,20): error TS2322: Type 'string' is not assignable to type '[any, ...any[]]'.
server/routes.ts(3442,38): error TS2339: Property 'getSubmission' does not exist on type 'IStorage'.
server/routes.ts(3459,38): error TS2339: Property 'getSubmission' does not exist on type 'IStorage'.
server/routes.ts(3752,9): error TS2322: Type 'Date' is not assignable to type 'string'.
server/routes.ts(3753,9): error TS2322: Type 'Date' is not assignable to type 'string'.
server/routes.ts(3848,9): error TS2353: Object literal may only specify known properties, and 'id' does not exist in type '{ tenantId: string; academicYearId: string; grade: string; isActive?: boolean | null | undefined; createdAt?: Date | null | undefined; gradeGroup?: string | null | undefined; displayName?: string | ... 1 more ... | undefined; }'.
server/routes.ts(3987,37): error TS2307: Cannot find module 'bcryptjs' or its corresponding type declarations.
server/routes.ts(3994,35): error TS2307: Cannot find module 'bcryptjs' or its corresponding type declarations.
server/routes.ts(4019,35): error TS2307: Cannot find module 'bcryptjs' or its corresponding type declarations.
server/routes.ts(4112,36): error TS2339: Property 'getUpload' does not exist on type 'IStorage'.
server/routes.ts(4427,35): error TS2307: Cannot find module 'bcryptjs' or its corresponding type declarations.
server/routes.ts(4574,64): error TS2345: Argument of type 'string | null' is not assignable to parameter of type 'string'.
  Type 'null' is not assignable to type 'string'.
server/routes.ts(4585,54): error TS2345: Argument of type 'string | null' is not assignable to parameter of type 'string'.
  Type 'null' is not assignable to type 'string'.
server/routes.ts(4658,46): error TS2339: Property 'isDeleted' does not exist on type '{ id: string; name: string; code: string; logo: string | null; active: boolean | null; principalName: string | null; address: string | null; city: string | null; state: string | null; ... 9 more ...; userCodeCounter: number | null; }'.
server/routes.ts(4665,27): error TS2339: Property 'principalEmail' does not exist on type '{ id: string; name: string; code: string; logo: string | null; active: boolean | null; principalName: string | null; address: string | null; city: string | null; state: string | null; ... 9 more ...; userCodeCounter: number | null; }'.
server/routes.ts(4666,27): error TS2551: Property 'principalPhone' does not exist on type '{ id: string; name: string; code: string; logo: string | null; active: boolean | null; principalName: string | null; address: string | null; city: string | null; state: string | null; ... 9 more ...; userCodeCounter: number | null; }'. Did you mean 'principalName'?
server/routes.ts(4668,22): error TS2339: Property 'createdAt' does not exist on type '{ id: string; name: string; code: string; logo: string | null; active: boolean | null; principalName: string | null; address: string | null; city: string | null; state: string | null; ... 9 more ...; userCodeCounter: number | null; }'.
server/routes.ts(4693,9): error TS2353: Object literal may only specify known properties, and 'principalEmail' does not exist in type '{ name: string; code: string; logo?: string | null | undefined; active?: boolean | null | undefined; principalName?: string | null | undefined; address?: string | null | undefined; city?: string | ... 1 more ... | undefined; ... 10 more ...; userCodeCounter?: number | ... 1 more ... | undefined; }'.
server/routes.ts(4897,32): error TS2339: Property 'isDeleted' does not exist on type '{ id: string; name: string; code: string; logo: string | null; active: boolean | null; principalName: string | null; address: string | null; city: string | null; state: string | null; ... 9 more ...; userCodeCounter: number | null; }'.
server/routes.ts(4940,50): error TS2345: Argument of type 'string | null' is not assignable to parameter of type 'string'.
  Type 'null' is not assignable to type 'string'.
server/routes.ts(5290,37): error TS2551: Property 'getTenants' does not exist on type 'IStorage'. Did you mean 'getTenant'?
server/routes.ts(5291,44): error TS7006: Parameter 's' implicitly has an 'any' type. to list all errors. Many are in the original codebase (e.g., ).
    - **Why to solve this issue and what will be achieved with this?** Ensures a stable build and improves long-term maintainability.
    - **Should Test frontend/backend/both after fix:** Frontend.
    - **Is recurring issue?** Y

**Known issue recurrence from previous fork**
- **Database service persistence:** The PostgreSQL service in the preview environment was lost on container restart and had to be reinstalled and re-seeded. The agent successfully handled this, but it's a known environmental characteristic.
- **Logic missing from :** This recurring bug class is now **permanently resolved** by the complete removal of .

**Code Architecture**


**Key Technical Concepts**
*   **Frontend:** React, TypeScript, Vite, Tailwind CSS, Shadcn UI
*   **Backend:** A hybrid microservice architecture with:
    *   **Main Service:** Node.js, Express.js
    *   **Parser Service:** Python, FastAPI
*   **Database:** PostgreSQL with Drizzle ORM
*   **AI:** OpenAI GPT-4 Vision for PDF/image parsing

**key DB schema**
- : Added  to govern visibility in student mock tests.
- : Table created for global content library.
- : Table created to support file uploads.

**All files of reference**
*   : The new FastAPI microservice that hosts the AI parsing logic.
*   : The core Python script that interfaces with the OpenAI API.
*   : The new React component for the AI Parser UI.
*   : The new supervisor config to run the Python service.
*   : Significantly refactored to remove  and export only the  interface.
*   : Updated to be the sole implementation of , with all data methods residing here.
*   : Heavily modified to remove mock data from the Principal dashboard and fix the HOD dashboard's exam dropdown to use API data.

**Areas that need refactoring**:
- The old admin pages at  are obsolete and should be removed in the future.

**key api endpoints**
*   : (POST) The new endpoint (proxied to the Python service) that handles AI question paper parsing.
*   : Now correctly fetches exams from the  table for the HOD dashboard.
*   : Now correctly fetches exams from the  table where  is true.

**Critical Info for New Agent**
*   **AI Parser Test is the Next Step:** The immediate task is to test the newly built AI Paper Parser. You must ask the user for their **OpenAI API key** and a **sample question paper (PDF/Image)**. Guide them on how to provide the key through the UI so you can perform the test.
*   **Phase Locked:** The user has explicitly locked the current phase of development. Do not start work on any other features (like PowerBI analytics or S3 integration) until the user gives the green light after they complete their internal demo.
*   **PostgreSQL is the Only Truth:** The application is now a pure PostgreSQL system. There is no in-memory fallback. All data logic must be implemented in .
*   **Environment state:** The PostgreSQL service may not be persistent across container restarts in this preview environment. If the backend fails to start with a database connection error, you may need to reinstall PostgreSQL and re-run the schema push and seeding steps.

**documents and test reports created in this job**
*    (Updated)
*   

**Last 10 User Messages and any pending HUMAN messages**
1.  **User:** Asks if a teacher can upload a PDF question paper and have the questions segregated by marks. (Feature Request)
2.  **Agent:** Clarifies that PDF parsing does not exist but can be built with AI, and asks for requirements.
3.  **User:** Asks for the current teacher upload flow.
4.  **Agent:** Details the existing manual and CSV upload flows for teachers.
5.  **User:** Confirms they want PDF/image parsing.
6.  **Agent:** Proposes a plan to build the feature using an AI provider and asks for confirmation on which to use (OpenAI or Gemini).
7.  **User:** Approves building the feature now, using **OpenAI**. Specifies it should be in the **Super Admin dashboard** and gives detailed UI/classification requirements.
8.  **Agent:** Acknowledges the plan and proceeds with implementation.
9.  **Agent:** Finishes the feature and presents a summary, asking the user to provide their OpenAI key and a sample file for testing.
10. **User:** Asks if they can share a 12th-grade computer science paper for the agent to test.
11. **Agent:** Agrees and re-confirms the need for the paper and the user's OpenAI API key to proceed with the test. **(PENDING USER RESPONSE)**

**Project Health Check:**
*   **Broken:** The PostgreSQL service within the preview environment can be volatile and may require a restart/reinstall if the container is reset.
*   **Mocked:** None. The system is now fully backed by a real database with no mock data.

**3rd Party Integrations**
*   **OpenAI GPT-4 Vision:** Integrated for the new AI Paper Parser feature. It requires a **User-provided API Key**.
*   **AWS S3:** Planned for file storage, but not yet configured with credentials.

**Testing status**
- **Testing agent used after significant changes:** YES, for the reference materials feature.
- **Troubleshoot agent used after agent stuck in loop:** NO
- **Test files created:** None
- **Known regressions:** None. Major sources of past regressions (dual storage engines) have been eliminated.

**Credentials to test flow:**
*   **Role:** Super Admin
*   **Email:** 
*   **Password:** 

**What agent forgot to execute**
- The agent has successfully executed all high-priority tasks requested by the user. Known, lower-priority backlog items like fixing pre-existing TypeScript errors and cleaning up old admin pages have been deferred, which is appropriate.</analysis>
